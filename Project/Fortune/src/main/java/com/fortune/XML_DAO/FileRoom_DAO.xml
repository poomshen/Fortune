<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper
PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN"
"http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<!-- 
	key point Mybatis 사용 프로젝트 진행시 
	1. mapper namespace 이름 : DAO 가지는 interface 이름을 그대로 
	2. <select id="" 이름을 interface 가지는 함수명과 동일 result : interface 와 mapper 있으면 실행 
	
	int insertBoard(BoardDTO dto); 
	int updateBoard(BoardDTO dto); 
	int deleteBoard(BoardDTO dto); 
	
	List<BoardDTO> getBoardList(HashMap map); 
	BoardDTO getBoard(int num); 
	
	void updateHit(int num); //조회수 증가 
	int getBoardCount(); //전체 글 수 
	
	void insertReply(BoardDTO dto); //답변처리
	void updateSort(BoardDTO dto); //답변 처리(step(sort) 값 변경) 
-->

<mapper namespace="com.fortune.fileroom_DAO.IFileRoom">
	<insert id="insertFile" parameterType="com.fortune.Table_DTO.FileRoom_DTO">
		insert into file_room values(1, 1, 'sung@gmail.com',sysdate, #{file_room_name}, (SELECT MAX(TO_NUMBER(file_room_no))+1 FROM file_room), #{file_room_ext})
	</insert>

	<!-- <select id="listFiles" parameterType="integer" resultType="com.fortune.Table_DTO.FileRoom_DTO">
		select * from file_room order by file_room_no desc 
	</select> -->
	
	<select id="listFiles" parameterType="integer" resultType="com.fortune.Table_DTO.FileRoom_DTO">
		select * from (select rownum num, n.* from (select * from file_room order by file_room_no desc) n)
		 where num between 1 + (#{page} - 1) * 9 and 9 + (#{page} - 1) * 9
	</select>
	
	
	<delete id="deleteFile" parameterType="com.fortune.Table_DTO.FileRoom_DTO">
		delete file_room where file_room_name = #{file_room_name}
	</delete>
	
	<select id="countFile" resultType="integer">
		select count(*) from file_room
	</select>
</mapper>